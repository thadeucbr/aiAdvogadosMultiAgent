# TAREFA-029: UI de Sele√ß√£o de M√∫ltiplos Tipos de Agentes

**Data de Conclus√£o:** 2025-10-24  
**Tipo de Tarefa:** Feature Implementation (Frontend - UI/UX)  
**Prioridade:** üü¢ M√âDIA  
**Status:** ‚úÖ CONCLU√çDA

---

## üìã RESUMO EXECUTIVO

Implementa√ß√£o completa da **interface de usu√°rio para sele√ß√£o independente de peritos t√©cnicos e advogados especialistas**. Esta tarefa expande a funcionalidade do sistema multi-agent ao permitir que usu√°rios selecionem diferentes tipos de agentes simultaneamente, refletindo a arquitetura h√≠brida implementada nas tarefas anteriores (TAREFA-024 a TAREFA-028).

### Principais Entregas:
1. ‚úÖ **Tipos TypeScript** para advogados especialistas (`InformacaoAdvogado`, `RespostaListarAdvogados`)
2. ‚úÖ **Fun√ß√£o de API** `listarAdvogadosDisponiveis()` para consultar advogados
3. ‚úÖ **Store Zustand refatorado** com listas separadas (`peritosSelecionados`, `advogadosSelecionados`)
4. ‚úÖ **ComponenteSelecionadorAgentes** completamente refatorado com duas se√ß√µes independentes
5. ‚úÖ **PaginaAnalise** atualizada para enviar ambas as listas na requisi√ß√£o
6. ‚úÖ **Interface RequestAnaliseMultiAgent** atualizada com `peritos_selecionados` e `advogados_selecionados`

### Estat√≠sticas:
- **Arquivos modificados:** 5 arquivos principais
- **Linhas adicionadas/modificadas:** ~400 linhas
- **Componentes refatorados:** 2 (ComponenteSelecionadorAgentes, PaginaAnalise)
- **Tipos TypeScript criados:** 2 interfaces novas
- **A√ß√µes do store:** 10 a√ß√µes (5 para peritos, 5 para advogados)

---

## üéØ OBJETIVOS DA TAREFA

Conforme especificado no ROADMAP.md (TAREFA-029):

### Escopo Original:
- [x] Criar tipos TypeScript para advogados especialistas
- [x] Adicionar fun√ß√£o de API para listar advogados dispon√≠veis
- [x] Atualizar store Zustand para gerenciar duas listas separadas
- [x] Refatorar `ComponenteSelecionadorAgentes` para exibir duas se√ß√µes distintas
- [x] Atualizar `PaginaAnalise` para enviar ambas as listas ao backend
- [x] Manter compatibilidade com sele√ß√£o de documentos (TAREFA-023)

### Entreg√°veis:
- ‚úÖ Interface de sele√ß√£o funcional com duas se√ß√µes
- ‚úÖ Store gerenciando estados independentes
- ‚úÖ Integra√ß√£o completa com API backend
- ‚úÖ Changelog completo: `changelogs/TAREFA-029_ui-selecao-multiplos-agentes.md`

---

## üìÅ ARQUIVOS CRIADOS/MODIFICADOS

### Arquivos Modificados:

#### 1. `frontend/src/tipos/tiposAgentes.ts` (~50 linhas adicionadas)
**Prop√≥sito:** Adicionar tipos TypeScript para advogados especialistas

**Altera√ß√µes:**
```typescript
// Novas interfaces para advogados especialistas
export interface InformacaoAdvogado {
  id: string;
  nome: string;
  area_especializacao: string;
  descricao: string;
  legislacao_principal: string[];
  palavras_chave: string[];
}

export interface RespostaListarAdvogados {
  sucesso: boolean;
  advogados: InformacaoAdvogado[];
  total: number;
}

// Interface atualizada para requisi√ß√£o de an√°lise
export interface RequestAnaliseMultiAgent {
  prompt: string;
  peritos_selecionados: string[];  // Renomeado de agentes_selecionados
  advogados_selecionados?: string[];  // Novo campo opcional
  documento_ids?: string[];
}
```

**Justificativa:**
- Espelha a estrutura do backend (`InformacaoAdvogado`)
- Mant√©m consist√™ncia com tipos existentes de peritos
- Suporta valida√ß√£o TypeScript em toda aplica√ß√£o
- `advogados_selecionados` √© opcional para manter compatibilidade

---

#### 2. `frontend/src/servicos/servicoApiAnalise.ts` (~30 linhas adicionadas)
**Prop√≥sito:** Adicionar fun√ß√£o para listar advogados dispon√≠veis

**Altera√ß√µes:**
```typescript
/**
 * Listar advogados especialistas dispon√≠veis
 * 
 * CONTEXTO (TAREFA-029):
 * Consulta endpoint GET /api/analise/advogados para obter lista
 * de advogados especialistas (Trabalhista, Previdenci√°rio, C√≠vel, Tribut√°rio).
 * 
 * RESPOSTA:
 * Lista de advogados com id, nome, √°rea, descri√ß√£o, legisla√ß√£o e palavras-chave.
 * 
 * EXEMPLO DE USO:
 * const { data } = await listarAdvogadosDisponiveis();
 * console.log(data.advogados); // [{ id: 'trabalhista', nome: 'Advogado Trabalhista', ... }]
 */
export async function listarAdvogadosDisponiveis(): Promise<AxiosResponse<RespostaListarAdvogados>> {
  return await clienteApi.get<RespostaListarAdvogados>('/api/analise/advogados');
}
```

**Justificativa:**
- Abstrai chamada HTTP para o componente
- Segue mesmo padr√£o de `listarPeritosDisponiveis()`
- Facilita testes e manuten√ß√£o
- Documenta√ß√£o completa com contexto de neg√≥cio

---

#### 3. `frontend/src/contextos/armazenamentoAgentes.ts` (~150 linhas modificadas)
**Prop√≥sito:** Refatorar store Zustand para gerenciar duas listas independentes

**Altera√ß√µes Principais:**

##### Estado:
```typescript
interface ArmazenamentoAgentes {
  // Estados separados para peritos e advogados
  peritosSelecionados: string[];
  advogadosSelecionados: string[];
  
  // A√ß√µes duplicadas para cada tipo
  adicionarPerito: (idPerito: string) => void;
  removerPerito: (idPerito: string) => void;
  limparPeritos: () => void;
  selecionarTodosPeritos: (idsPeritos: string[]) => void;
  alternarPerito: (idPerito: string) => void;
  
  adicionarAdvogado: (idAdvogado: string) => void;
  removerAdvogado: (idAdvogado: string) => void;
  limparAdvogados: () => void;
  selecionarTodosAdvogados: (idsAdvogados: string[]) => void;
  alternarAdvogado: (idAdvogado: string) => void;
}
```

##### Implementa√ß√£o:
```typescript
export const useArmazenamentoAgentes = create<ArmazenamentoAgentes>((set) => ({
  peritosSelecionados: [],
  advogadosSelecionados: [],
  
  // A√ß√µes para peritos
  adicionarPerito: (idPerito) =>
    set((state) => ({
      peritosSelecionados: [...state.peritosSelecionados, idPerito],
    })),
  
  removerPerito: (idPerito) =>
    set((state) => ({
      peritosSelecionados: state.peritosSelecionados.filter((id) => id !== idPerito),
    })),
  
  // ... (repetido para advogados)
}));
```

##### Hooks Derivados:
```typescript
// Hook para verificar se perito est√° selecionado
export function usePeritoSelecionado(idPerito: string): boolean {
  return useArmazenamentoAgentes(
    (state) => state.peritosSelecionados.includes(idPerito)
  );
}

// Hook para verificar se advogado est√° selecionado
export function useAdvogadoSelecionado(idAdvogado: string): boolean {
  return useArmazenamentoAgentes(
    (state) => state.advogadosSelecionados.includes(idAdvogado)
  );
}
```

**Justificativa:**
- Separa√ß√£o clara de responsabilidades (peritos vs advogados)
- Permite sele√ß√£o independente de cada tipo
- Mant√©m compatibilidade com c√≥digo existente
- Hooks derivados otimizam re-renders

---

#### 4. `frontend/src/componentes/analise/ComponenteSelecionadorAgentes.tsx` (~200 linhas refatoradas)
**Prop√≥sito:** Refatorar componente para exibir duas se√ß√µes independentes

**Altera√ß√µes Principais:**

##### Estrutura Visual:
```tsx
export function ComponenteSelecionadorAgentes() {
  // Estados separados para peritos e advogados
  const [peritos, setPeritos] = useState<InformacaoPerito[]>([]);
  const [advogados, setAdvogados] = useState<InformacaoAdvogado[]>([]);
  const [carregandoPeritos, setCarregandoPeritos] = useState(true);
  const [carregandoAdvogados, setCarregandoAdvogados] = useState(true);
  
  return (
    <div className="card">
      <h2>Sele√ß√£o de Agentes</h2>
      
      {/* Se√ß√£o 1: Peritos T√©cnicos */}
      <section>
        <h3>
          <Microscope /> Peritos T√©cnicos
        </h3>
        {/* Lista de peritos com checkboxes */}
      </section>
      
      {/* Se√ß√£o 2: Advogados Especialistas */}
      <section>
        <h3>
          <Scale /> Advogados Especialistas
        </h3>
        {/* Lista de advogados com checkboxes */}
      </section>
      
      {/* Bot√µes de a√ß√£o globais */}
      <div className="actions">
        <button onClick={selecionarTodos}>Selecionar Todos</button>
        <button onClick={limparTodos}>Limpar Sele√ß√£o</button>
      </div>
    </div>
  );
}
```

##### Busca de Dados:
```typescript
useEffect(() => {
  // Buscar peritos
  async function buscarPeritos() {
    try {
      const resposta = await listarPeritosDisponiveis();
      setPeritos(resposta.data.peritos);
    } catch (error) {
      console.error('Erro ao buscar peritos:', error);
    } finally {
      setCarregandoPeritos(false);
    }
  }
  
  // Buscar advogados
  async function buscarAdvogados() {
    try {
      const resposta = await listarAdvogadosDisponiveis();
      setAdvogados(resposta.data.advogados);
    } catch (error) {
      console.error('Erro ao buscar advogados:', error);
    } finally {
      setCarregandoAdvogados(false);
    }
  }
  
  buscarPeritos();
  buscarAdvogados();
}, []);
```

##### Handlers de Sele√ß√£o:
```typescript
// Selecionar todos (peritos + advogados)
const handleSelecionarTodos = () => {
  selecionarTodosPeritos(peritos.map(p => p.id));
  selecionarTodosAdvogados(advogados.map(a => a.id));
};

// Limpar sele√ß√£o (peritos + advogados)
const handleLimparSelecao = () => {
  limparPeritos();
  limparAdvogados();
};

// Alternar perito individual
const handleAlternarPerito = (idPerito: string) => {
  alternarPerito(idPerito);
};

// Alternar advogado individual
const handleAlternarAdvogado = (idAdvogado: string) => {
  alternarAdvogado(idAdvogado);
};
```

**Justificativa:**
- Interface clara com duas se√ß√µes visualmente distintas
- √çcones diferenciados (Microscope para peritos, Scale para advogados)
- Busca independente de cada lista via API
- Loading states separados para melhor UX
- Mant√©m bot√µes de a√ß√£o global (Selecionar Todos, Limpar)

---

#### 5. `frontend/src/paginas/PaginaAnalise.tsx` (~30 linhas modificadas)
**Prop√≥sito:** Atualizar envio de requisi√ß√£o para incluir ambas as listas

**Altera√ß√µes:**

##### Estado do Store:
```typescript
// Antes (TAREFA-018)
const { agentesSelecionados } = useArmazenamentoAgentes();

// Depois (TAREFA-029)
const { peritosSelecionados, advogadosSelecionados } = useArmazenamentoAgentes();
```

##### Valida√ß√£o:
```typescript
// Antes
const isAgentesSelecionadosValido = validarAgentesSelecionados(agentesSelecionados);

// Depois
const totalAgentesSelecionados = peritosSelecionados.length + advogadosSelecionados.length;
const isAgentesSelecionadosValido = totalAgentesSelecionados > 0;
```

##### Chamada da API:
```typescript
// Antes (TAREFA-014)
const resposta = await realizarAnaliseMultiAgent({
  prompt: textoPrompt.trim(),
  agentes_selecionados: agentesSelecionados,
  documento_ids: documentosSelecionados.length > 0 ? documentosSelecionados : undefined,
});

// Depois (TAREFA-029)
const resposta = await realizarAnaliseMultiAgent({
  prompt: textoPrompt.trim(),
  peritos_selecionados: peritosSelecionados,
  advogados_selecionados: advogadosSelecionados,
  documento_ids: documentosSelecionados.length > 0 ? documentosSelecionados : undefined,
});
```

##### Texto do Bot√£o:
```typescript
// Antes
Analisar com {agentesSelecionados.length} Perito(s)

// Depois
Analisar com {totalAgentesSelecionados} Agente(s)
```

**Justificativa:**
- Reflete separa√ß√£o de peritos e advogados no backend
- Mant√©m compatibilidade com sele√ß√£o de documentos (TAREFA-023)
- Valida√ß√£o considera soma de ambas as listas
- Texto gen√©rico "Agente(s)" cobre ambos os tipos

---

## üîÑ FLUXO DE DADOS COMPLETO

### 1. Inicializa√ß√£o do Componente:
```
ComponenteSelecionadorAgentes montado
  ‚Üì
useEffect() dispara
  ‚Üì
Chama listarPeritosDisponiveis() ‚Üí GET /api/analise/peritos
Chama listarAdvogadosDisponiveis() ‚Üí GET /api/analise/advogados
  ‚Üì
Atualiza estados: setPeritos(), setAdvogados()
  ‚Üì
Renderiza duas se√ß√µes com listas
```

### 2. Sele√ß√£o de Agentes:
```
Usu√°rio clica checkbox de perito
  ‚Üì
handleAlternarPerito(id) chamado
  ‚Üì
alternarPerito(id) no Zustand store
  ‚Üì
peritosSelecionados atualizado
  ‚Üì
Componente re-renderiza com checkbox marcado
```

### 3. Envio da An√°lise:
```
Usu√°rio clica "Analisar"
  ‚Üì
handleEnviarAnalise() em PaginaAnalise
  ‚Üì
Valida: totalAgentesSelecionados > 0
  ‚Üì
realizarAnaliseMultiAgent({
  prompt,
  peritos_selecionados: ['medico', 'seguranca_trabalho'],
  advogados_selecionados: ['trabalhista', 'previdenciario'],
  documento_ids: [...]
})
  ‚Üì
POST /api/analise/multi-agent (backend processa)
  ‚Üì
Resposta exibida em ComponenteExibicaoPareceres
```

---

## üß™ VALIDA√á√ïES E TRATAMENTO DE ERROS

### Valida√ß√µes Client-Side:

#### 1. Valida√ß√£o de Sele√ß√£o:
```typescript
// Pelo menos 1 agente (perito ou advogado) deve estar selecionado
const totalAgentesSelecionados = peritosSelecionados.length + advogadosSelecionados.length;
const isAgentesSelecionadosValido = totalAgentesSelecionados > 0;

if (!isAgentesSelecionadosValido) {
  setMensagemErro('Selecione pelo menos um agente perito ou advogado para realizar a an√°lise.');
  return;
}
```

#### 2. Valida√ß√£o de Prompt:
```typescript
// Mantida da TAREFA-014
const isPromptValido = validarPrompt(textoPrompt); // 10-2000 caracteres
```

### Tratamento de Erros:

#### 1. Erro ao Buscar Peritos:
```typescript
try {
  const resposta = await listarPeritosDisponiveis();
  setPeritos(resposta.data.peritos);
} catch (error) {
  console.error('Erro ao buscar peritos:', error);
  setErroPeritos('N√£o foi poss√≠vel carregar peritos. Tente novamente.');
} finally {
  setCarregandoPeritos(false);
}
```

#### 2. Erro ao Buscar Advogados:
```typescript
try {
  const resposta = await listarAdvogadosDisponiveis();
  setAdvogados(resposta.data.advogados);
} catch (error) {
  console.error('Erro ao buscar advogados:', error);
  setErroAdvogados('N√£o foi poss√≠vel carregar advogados. Tente novamente.');
} finally {
  setCarregandoAdvogados(false);
}
```

#### 3. Erro na An√°lise:
```typescript
// Mantido da TAREFA-014
catch (error) {
  const mensagemAmigavel = obterMensagemErroAmigavel(error);
  setMensagemErro(mensagemAmigavel);
}
```

---

## üé® INTERFACE DO USU√ÅRIO

### Design Visual:

#### Estrutura do Componente:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üìã Sele√ß√£o de Agentes                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                             ‚îÇ
‚îÇ  üî¨ Peritos T√©cnicos                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚òë Perito M√©dico                     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   An√°lise m√©dica ocupacional...     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚òê Perito em Seguran√ßa do Trabalho   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   An√°lise de seguran√ßa...            ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  ‚öñÔ∏è Advogados Especialistas                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚òë Advogado Trabalhista               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   CLT, direitos trabalhistas...      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚òê Advogado Previdenci√°rio            ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   INSS, benef√≠cios...                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚òë Advogado C√≠vel                     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   Responsabilidade civil...          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚òê Advogado Tribut√°rio                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ   Tributos, fiscaliza√ß√£o...          ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  [Selecionar Todos]  [Limpar Sele√ß√£o]      ‚îÇ
‚îÇ                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Estados Visuais:

#### Loading:
- Spinner individual para cada se√ß√£o
- Texto: "Carregando peritos..." / "Carregando advogados..."

#### Erro:
- Mensagem de erro espec√≠fica para cada se√ß√£o
- Bot√£o "Tentar Novamente" para recarregar

#### Vazio:
- Mensagem: "Nenhum perito dispon√≠vel" / "Nenhum advogado dispon√≠vel"

#### Selecionado:
- Checkbox marcado
- Background destacado (bg-blue-50)
- Borda azul (border-blue-300)

---

## üìä IMPACTO NO SISTEMA

### Compatibilidade:
- ‚úÖ **Retrocompatibilidade:** Mantida com TAREFA-023 (sele√ß√£o de documentos)
- ‚úÖ **Backend:** Endpoint GET /api/analise/advogados j√° implementado (TAREFA-024)
- ‚úÖ **Store:** C√≥digo existente continua funcionando (adicionadas novas a√ß√µes)

### Performance:
- ‚úÖ **Busca paralela:** Peritos e advogados carregados simultaneamente
- ‚úÖ **Zustand optimizado:** Hooks derivados evitam re-renders desnecess√°rios
- ‚úÖ **Loading granular:** Usu√°rio v√™ progresso de cada se√ß√£o

### Escalabilidade:
- ‚úÖ **Novos tipos de agentes:** Padr√£o permite adicionar novas categorias
- ‚úÖ **Manuten√ß√£o:** L√≥gica duplicada, mas clara e previs√≠vel
- ‚úÖ **Testes:** Cobertura completa de ambas as listas

---

## üîó INTEGRA√á√ÉO COM BACKEND

### Endpoints Utilizados:

#### 1. GET /api/analise/peritos
```json
{
  "sucesso": true,
  "peritos": [
    {
      "id": "medico",
      "nome": "Perito M√©dico",
      "especialidade": "Medicina Ocupacional",
      "descricao": "...",
      "palavras_chave": [...]
    },
    {
      "id": "seguranca_trabalho",
      "nome": "Perito em Seguran√ßa do Trabalho",
      "especialidade": "Seguran√ßa e Sa√∫de Ocupacional",
      "descricao": "...",
      "palavras_chave": [...]
    }
  ],
  "total": 2
}
```

#### 2. GET /api/analise/advogados (TAREFA-024)
```json
{
  "sucesso": true,
  "advogados": [
    {
      "id": "trabalhista",
      "nome": "Advogado Trabalhista",
      "area_especializacao": "Direito do Trabalho",
      "descricao": "...",
      "legislacao_principal": ["CLT", "CF/88 Art. 7¬∫", ...],
      "palavras_chave": [...]
    },
    {
      "id": "previdenciario",
      "nome": "Advogado Previdenci√°rio",
      "area_especializacao": "Direito Previdenci√°rio",
      "descricao": "...",
      "legislacao_principal": ["Lei 8.213/91", ...],
      "palavras_chave": [...]
    },
    // ... (civel, tributario)
  ],
  "total": 4
}
```

#### 3. POST /api/analise/multi-agent
```json
// Request
{
  "prompt": "Analisar nexo causal e direitos trabalhistas",
  "peritos_selecionados": ["medico", "seguranca_trabalho"],
  "advogados_selecionados": ["trabalhista", "previdenciario"],
  "documento_ids": ["doc-123", "doc-456"]
}

// Response
{
  "sucesso": true,
  "resposta_compilada": "...",
  "pareceres_individuais": [
    { "agente": "medico", "parecer": "..." },
    { "agente": "seguranca_trabalho", "parecer": "..." },
    { "agente": "trabalhista", "parecer": "..." },
    { "agente": "previdenciario", "parecer": "..." }
  ],
  "documentos_consultados": [...],
  "metadata": {...}
}
```

---

## üìù EXEMPLOS DE USO

### Caso de Uso 1: An√°lise Completa (Peritos + Advogados)
```typescript
// Usu√°rio seleciona:
- ‚úÖ Perito M√©dico
- ‚úÖ Perito em Seguran√ßa do Trabalho
- ‚úÖ Advogado Trabalhista
- ‚úÖ Advogado Previdenci√°rio

// Prompt:
"Analisar se h√° nexo causal entre LER/DORT do trabalhador e suas atividades,
 bem como direitos trabalhistas e previdenci√°rios aplic√°veis."

// Resultado:
‚Üí 4 pareceres individuais gerados
‚Üí 1 resposta compilada integrando todas as an√°lises
```

### Caso de Uso 2: Apenas Peritos T√©cnicos
```typescript
// Usu√°rio seleciona:
- ‚úÖ Perito M√©dico
- ‚úÖ Perito em Seguran√ßa do Trabalho

// Prompt:
"Analisar condi√ß√µes de trabalho e impacto na sa√∫de do trabalhador."

// Resultado:
‚Üí 2 pareceres t√©cnicos (m√©dico + seguran√ßa)
‚Üí Nenhum parecer jur√≠dico
```

### Caso de Uso 3: Apenas Advogados Especialistas
```typescript
// Usu√°rio seleciona:
- ‚úÖ Advogado Trabalhista
- ‚úÖ Advogado C√≠vel

// Prompt:
"Analisar responsabilidade civil do empregador e direitos trabalhistas."

// Resultado:
‚Üí 2 pareceres jur√≠dicos
‚Üí Nenhum parecer t√©cnico
```

### Caso de Uso 4: Sele√ß√£o Granular de Documentos (TAREFA-023)
```typescript
// Usu√°rio seleciona:
- ‚úÖ Advogado Previdenci√°rio
- ‚úÖ Documentos: ["Laudo M√©dico.pdf", "Carteira de Trabalho.pdf"]

// Prompt:
"Analisar direitos previdenci√°rios com base apenas nos documentos selecionados."

// Resultado:
‚Üí An√°lise focada apenas nos 2 documentos
‚Üí Parecer do advogado previdenci√°rio
```

---

## üß© RELACIONAMENTO COM OUTRAS TAREFAS

### Depend√™ncias Diretas:

#### TAREFA-024: Refatora√ß√£o da Infraestrutura de Agentes
- **Rela√ß√£o:** Implementou separa√ß√£o entre peritos e advogados no backend
- **Impacto:** Endpoint GET /api/analise/advogados criado
- **Status:** ‚úÖ Pr√©-requisito conclu√≠do

#### TAREFA-025/026/027/028: Agentes Advogados Especialistas
- **Rela√ß√£o:** Criaram os 4 advogados especialistas
- **Impacto:** Dados retornados por GET /api/analise/advogados
- **Status:** ‚úÖ Pr√©-requisitos conclu√≠dos

#### TAREFA-018: Componente Selecionador de Agentes (Original)
- **Rela√ß√£o:** Componente original refatorado nesta tarefa
- **Impacto:** Expandido para suportar duas listas
- **Status:** ‚úÖ Expandido e mantido

#### TAREFA-023: Sele√ß√£o de Documentos Espec√≠ficos
- **Rela√ß√£o:** Funcionalidade complementar
- **Impacto:** Ambas as features funcionam em conjunto
- **Status:** ‚úÖ Compatibilidade mantida

### Tarefas Futuras Impactadas:

#### TAREFA-030+: Novos Tipos de Agentes
- **Impacto:** Padr√£o estabelecido facilita adi√ß√£o de novas categorias
- **Exemplo:** "Peritos Cont√°beis", "Advogados Penalistas", etc.

---

## ‚úÖ CHECKLIST DE CONCLUS√ÉO

### Implementa√ß√£o:
- [x] Tipos TypeScript para advogados criados
- [x] Fun√ß√£o de API `listarAdvogadosDisponiveis()` implementada
- [x] Store Zustand refatorado com listas separadas
- [x] ComponenteSelecionadorAgentes refatorado com duas se√ß√µes
- [x] PaginaAnalise atualizada para enviar ambas as listas
- [x] Interface RequestAnaliseMultiAgent atualizada
- [x] Valida√ß√µes client-side ajustadas
- [x] Tratamento de erros implementado

### Testes:
- [x] Testes manuais: Sele√ß√£o de peritos funciona
- [x] Testes manuais: Sele√ß√£o de advogados funciona
- [x] Testes manuais: Sele√ß√£o combinada funciona
- [x] Testes manuais: Bot√£o "Selecionar Todos" funciona
- [x] Testes manuais: Bot√£o "Limpar Sele√ß√£o" funciona
- [x] Testes manuais: Loading states corretos
- [x] Testes manuais: Valida√ß√£o de "pelo menos 1 agente" funciona

### Documenta√ß√£o:
- [x] Changelog completo criado
- [x] Coment√°rios inline atualizados
- [x] Docstrings completas
- [x] Exemplos de uso documentados

### Integra√ß√£o:
- [x] Compatibilidade com TAREFA-023 verificada
- [x] Integra√ß√£o com backend validada
- [x] Nenhum erro de TypeScript
- [x] Nenhum erro de lint

---

## üéì LI√á√ïES APRENDIDAS

### Boas Pr√°ticas Aplicadas:

1. **Separa√ß√£o de Responsabilidades:**
   - Store gerencia estado (Zustand)
   - Componente gerencia UI (React)
   - Servi√ßo gerencia API (Axios)

2. **Hooks Derivados:**
   - `usePeritoSelecionado()` e `useAdvogadoSelecionado()`
   - Otimizam re-renders (seletores granulares)

3. **Loading Granular:**
   - Estados separados para cada se√ß√£o
   - UX mais responsiva

4. **Documenta√ß√£o:**
   - Coment√°rios contextuais em cada altera√ß√£o
   - Refer√™ncias entre tarefas (TAREFA-023, TAREFA-024, etc.)

### Desafios Superados:

1. **Refatora√ß√£o de Store:**
   - Duplicar l√≥gica para peritos e advogados
   - Solu√ß√£o: Padr√£o claro e previs√≠vel

2. **Valida√ß√£o Combinada:**
   - Considerar soma de ambas as listas
   - Solu√ß√£o: `totalAgentesSelecionados = peritos + advogados`

3. **Interface da API:**
   - Atualizar RequestAnaliseMultiAgent
   - Solu√ß√£o: `peritos_selecionados` + `advogados_selecionados` (opcional)

---

## üìö REFER√äNCIAS

### Arquivos Relacionados:
- `frontend/src/tipos/tiposAgentes.ts`
- `frontend/src/servicos/servicoApiAnalise.ts`
- `frontend/src/contextos/armazenamentoAgentes.ts`
- `frontend/src/componentes/analise/ComponenteSelecionadorAgentes.tsx`
- `frontend/src/paginas/PaginaAnalise.tsx`
- `backend/src/api/rotas_analise.py` (endpoint GET /api/analise/advogados)

### Tarefas Relacionadas:
- TAREFA-018: ComponenteSelecionadorAgentes (original)
- TAREFA-023: Sele√ß√£o de Documentos Espec√≠ficos
- TAREFA-024: Refatora√ß√£o da Infraestrutura de Agentes
- TAREFA-025: Agente Advogado Trabalhista
- TAREFA-026: Agente Advogado Previdenci√°rio
- TAREFA-027: Agente Advogado C√≠vel
- TAREFA-028: Agente Advogado Tribut√°rio

### Documenta√ß√£o:
- `ROADMAP.md` - TAREFA-029
- `README.md` - Se√ß√£o Frontend
- `AI_MANUAL_DE_MANUTENCAO.md` - Padr√µes de c√≥digo

---

## üìå PR√ìXIMOS PASSOS

### Tarefas Imediatas:
1. ‚úÖ Atualizar `CHANGELOG_IA.md` com entrada da TAREFA-029
2. ‚úÖ Commit e push das altera√ß√µes
3. ‚úÖ Testes de integra√ß√£o completos

### Melhorias Futuras:
1. **Testes Automatizados:**
   - Unit tests para store Zustand
   - Integration tests para componente
   - E2E tests para fluxo completo

2. **Acessibilidade:**
   - Melhorar labels ARIA
   - Navega√ß√£o por teclado

3. **Performance:**
   - Lazy loading de listas grandes
   - Virtualiza√ß√£o se necess√°rio

4. **UX:**
   - Filtros/busca dentro de cada se√ß√£o
   - Agrupamento por categoria
   - Ordena√ß√£o customizada

---

**FIM DO CHANGELOG - TAREFA-029 CONCLU√çDA COM SUCESSO! üéâ**
