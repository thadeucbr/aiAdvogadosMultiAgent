Entendido. Solicita√ß√£o de refatora√ß√£o do roadmap recebida.

**Mudan√ßas Executadas:**
1.  **Remo√ß√£o de Testes:** A `FASE 4: TESTES E QUALIDADE (TAREFAS 022-025)` foi completamente removida.
2.  **Adi√ß√£o de Advogados Especialistas:** Uma nova fase (`FASE 4: EXPANS√ÉO - AGENTES E CONTEXTO`) foi adicionada. Ela inclui a refatora√ß√£o da infraestrutura de agentes e a cria√ß√£o de m√∫ltiplos agentes advogados especialistas (Trabalhista, Previdenci√°rio, C√≠vel, Tribut√°rio).
3.  **Adi√ß√£o de Sele√ß√£o de Arquivos:** A nova `FASE 4` tamb√©m inclui as tarefas de back-end e front-end para permitir que o usu√°rio selecione *quais* documentos do RAG devem ser usados em uma an√°lise espec√≠fica.
4.  **Re-numera√ß√£o:** As FASES 5 (Melhorias) e 6 (Deploy) foram re-numeradas para FASE 5 e FASE 6, e suas tarefas internas (de 026+ para 030+) foram atualizadas.
5.  **Status:** O status do projeto foi atualizado. O `Pr√≥ximo passo` agora √© a primeira tarefa da nova fase de expans√£o.

Aqui est√° o **Roadmap v2.0** atualizado:

---

# üó∫Ô∏è ROADMAP - PLATAFORMA JUR√çDICA MULTI-AGENT

**Vers√£o:** 2.0.0  
**√öltima Atualiza√ß√£o:** 2025-10-24  
**Objetivo:** Plataforma completa para an√°lise jur√≠dica com sistema multi-agent, RAG, advogados especialistas e sele√ß√£o granular de contexto.

---

## üìç Status Atual

**Conclu√≠do (v1.0.0):**
- ‚úÖ TAREFA-001: Funda√ß√£o do projeto (estrutura, documenta√ß√£o, governan√ßa)
- ‚úÖ TAREFA-001.1: Estrutura modular de changelogs
- ‚úÖ TAREFA-002: Setup do backend (FastAPI, configura√ß√µes, depend√™ncias)
- ‚úÖ TAREFA-003: Endpoint de upload de documentos (POST /api/documentos/upload)
- ‚úÖ TAREFA-004: Servi√ßo de Extra√ß√£o de Texto (PDFs e DOCX)
- ‚úÖ TAREFA-005A: Containeriza√ß√£o com Docker (n√£o mapeada)
- ‚úÖ TAREFA-005: Servi√ßo de OCR (Tesseract)
- ‚úÖ TAREFA-006: Servi√ßo de Chunking e Vetoriza√ß√£o
- ‚úÖ TAREFA-007: Integra√ß√£o com ChromaDB
- ‚úÖ TAREFA-008: Orquestra√ß√£o do Fluxo de Ingest√£o
- ‚úÖ TAREFA-009: Infraestrutura Base para Agentes
- ‚úÖ TAREFA-010: Agente Advogado (Coordenador)
- ‚úÖ TAREFA-011: Agente Perito M√©dico
- ‚úÖ TAREFA-012: Agente Perito Seguran√ßa do Trabalho
- ‚úÖ TAREFA-013: Orquestrador Multi-Agent
- ‚úÖ TAREFA-014: Endpoint de an√°lise multi-agent (API REST)
- ‚úÖ TAREFA-015: Setup do Frontend (React + Vite)
- ‚úÖ TAREFA-016: Componente de Upload de Documentos
- ‚úÖ TAREFA-017: Exibi√ß√£o de Shortcuts Sugeridos
- ‚úÖ TAREFA-018: Componente de Sele√ß√£o de Agentes
- ‚úÖ TAREFA-019: Interface de Consulta e An√°lise
- ‚úÖ TAREFA-020: Componente de Exibi√ß√£o de Pareceres
- ‚úÖ TAREFA-021: P√°gina de Hist√≥rico de Documentos
- ‚úÖ TAREFA-022: Atualizar API de An√°lise para Sele√ß√£o de Documentos
- ‚úÖ TAREFA-023: Componente de Sele√ß√£o de Documentos na An√°lise (Frontend)
- ‚úÖ TAREFA-024: Refatorar Infraestrutura de Agentes para Advogados Especialistas
- ‚úÖ TAREFA-025: Criar Agente Advogado Especialista - Direito do Trabalho
- ‚úÖ TAREFA-026: Criar Agente Advogado Especialista - Direito Previdenci√°rio
- ‚úÖ TAREFA-027: Criar Agente Advogado Especialista - Direito C√≠vel
- ‚úÖ TAREFA-028: Criar Agente Advogado Especialista - Direito Tribut√°rio
- ‚úÖ TAREFA-029: Atualizar UI para Sele√ß√£o de M√∫ltiplos Agentes
- ‚úÖ TAREFA-030: Backend - Refatorar Orquestrador para Background Tasks

**Pr√≥ximo passo:** TAREFA-031 (Backend - Criar Endpoints de An√°lise Ass√≠ncrona)

---

## üéØ VIS√ÉO GERAL DO PROJETO

### Funcionalidades Principais:

1. **Ingest√£o de Documentos**
   - Upload de PDFs, DOCX, imagens
   - OCR para documentos escaneados
   - Vetoriza√ß√£o e armazenamento no RAG (ChromaDB)

2. **An√°lise Multi-Agent**
   - Agente Advogado (coordenador)
   - Agentes Peritos (M√©dico, Seguran√ßa do Trabalho)
   - **(v2.0)** M√∫ltiplos Agentes Advogados Especialistas (Trabalhista, Previdenci√°rio, C√≠vel, etc.)
   - Gera√ß√£o de pareceres t√©cnicos automatizados

3. **Interface Web**
   - Upload drag-and-drop
   - Sele√ß√£o de agentes (Peritos e Advogados)
   - **(v2.0)** Sele√ß√£o granular de documentos para an√°lise
   - Visualiza√ß√£o de pareceres

---

## üìã ROADMAP COMPLETO

### üîµ FASE 1: BACKEND - INGEST√ÉO DE DOCUMENTOS (TAREFAS 003-008)

**Status:** ‚úÖ **CONCLU√çDA**
*(Tarefas 003 a 008 omitidas para brevidade, pois est√£o conclu√≠das)*

---

### üîµ FASE 2: BACKEND - SISTEMA MULTI-AGENT (TAREFAS 009-014)

**Status:** ‚úÖ **CONCLU√çDA**
*(Tarefas 009 a 014 omitidas para brevidade, pois est√£o conclu√≠das)*

---

### üîµ FASE 3: FRONTEND - INTERFACE WEB (TAREFAS 015-021)

**Status:** ‚úÖ **CONCLU√çDA**
*(Tarefas 015 a 021 omitidas para brevidade, pois est√£o conclu√≠das)*

---

### üîµ FASE 4: EXPANS√ÉO - AGENTES E CONTEXTO (TAREFAS 022-029)

**Objetivo:** Adicionar sele√ß√£o granular de contexto (arquivos) e expandir o sistema para incluir advogados especialistas.

---

#### ‚úÖ TAREFA-022: Atualizar API de An√°lise para Sele√ß√£o de Documentos
**Prioridade:** üî¥ CR√çTICA  
**Depend√™ncias:** TAREFA-014  
**Estimativa:** 2-3 horas  
**Status:** ‚úÖ CONCLU√çDA (2025-10-24)

**Escopo:**
- [x] Modificar `POST /api/analise/multi-agent`
- [x] Adicionar ao Request Body: `documento_ids: list[str] (opcional)`
- [x] Atualizar `OrquestradorMultiAgent` (TAREFA-013)
- [x] Modificar `AgenteAdvogado` (TAREFA-010) para que o m√©todo `consultar_rag` use os `documento_ids` para filtrar a busca no ChromaDB.
- [x] Se `documento_ids` for nulo ou vazio, manter comportamento atual (buscar em todos os documentos).
- [x] Documentar nova op√ß√£o no `ARQUITETURA.md`

**Entreg√°veis:**
- ‚úÖ API de an√°lise capaz de filtrar o contexto RAG por documentos espec√≠ficos.
- ‚úÖ Changelog completo: `changelogs/TAREFA-022_selecao-documentos-analise.md`

---

#### ‚úÖ TAREFA-023: Componente de Sele√ß√£o de Documentos na An√°lise
**Prioridade:** üî¥ CR√çTICA  
**Depend√™ncias:** TAREFA-021, TAREFA-022  
**Estimativa:** 3-4 horas  
**Status:** ‚úÖ CONCLU√çDA (2025-10-24)

**Escopo:**
- [x] Criar `frontend/src/componentes/analise/ComponenteSelecionadorDocumentos.tsx`
- [x] Na `PaginaAnalise.tsx`, antes do campo de prompt, buscar a lista de documentos (usando `servicoApiDocumentos.listarDocumentos()`, da TAREFA-021).
- [x] Exibir uma lista de checkboxes com os documentos dispon√≠veis.
- [x] Adicionar bot√µes "Selecionar Todos" / "Limpar Sele√ß√£o".
- [x] Modificar `PaginaAnalise.tsx` para passar a lista de `documento_ids` selecionados na chamada da API `realizarAnaliseMultiAgent`.

**Entreg√°veis:**
- ‚úÖ UI que permite ao usu√°rio selecionar quais arquivos espec√≠ficos ser√£o usados na an√°lise.
- ‚úÖ Changelog completo: `changelogs/TAREFA-023_componente-selecao-documentos-analise.md`

---

#### ‚úÖ TAREFA-024: Refatorar Infra de Agentes para Advogados Especialistas
**Prioridade:** üî¥ CR√çTICA  
**Depend√™ncias:** TAREFA-013  
**Estimativa:** 3-4 horas  
**Status:** ‚úÖ CONCLU√çDA (2025-10-24)

**Escopo:**
- [x] Criar `backend/src/agentes/agente_advogado_base.py` (similar ao `agente_base.py` mas para advogados).
- [x] Atualizar `OrquestradorMultiAgent` (TAREFA-013) para aceitar uma *segunda lista* de agentes: `advogados_selecionados: list[str]`.
- [x] Atualizar `AgenteAdvogadoCoordenador` (TAREFA-010):
  - [x] O Coordenador agora ir√° delegar para Peritos *E* para Advogados Especialistas (em paralelo).
  - [x] O m√©todo `compilar_resposta` agora deve compilar os pareceres dos peritos + os pareceres dos advogados especialistas.
- [x] Criar endpoint `GET /api/analise/advogados` para listar especialistas dispon√≠veis.

**Entreg√°veis:**
- ‚úÖ Infraestrutura de orquestra√ß√£o capaz de lidar com dois tipos de agentes (Peritos e Advogados).
- ‚úÖ Changelog completo: `changelogs/TAREFA-024_refatorar-infra-agentes-advogados.md`

---

#### ‚úÖ TAREFA-025: Criar Agente Advogado Especialista - Direito do Trabalho
**Prioridade:** üü° ALTA  
**Depend√™ncias:** TAREFA-024  
**Estimativa:** 2-3 horas  
**Status:** ‚úÖ CONCLU√çDA (2025-10-24)

**Escopo:**
- [x] Criar `backend/src/agentes/agente_advogado_trabalhista.py`
- [x] Herdar de `AgenteAdvogadoBase`.
- [x] Criar prompt focado na an√°lise jur√≠dica (vis√£o do advogado) de:
  - Verbas rescis√≥rias, justa causa.
  - Horas extras, adicional noturno, intrajornada.
  - Dano moral, ass√©dio.
  - An√°lise de conformidade com CLT e S√∫mulas do TST.
- [x] Registrar agente no `OrquestradorMultiAgent`.

**Entreg√°veis:**
- ‚úÖ Agente Advogado Trabalhista funcional.
- ‚úÖ Testes unit√°rios completos (test_agente_advogado_trabalhista.py)
- ‚úÖ Changelog completo: `changelogs/TAREFA-025_agente-advogado-trabalhista.md`

---

#### ‚úÖ TAREFA-026: Criar Agente Advogado Especialista - Direito Previdenci√°rio
**Prioridade:** üü° ALTA  
**Depend√™ncias:** TAREFA-024  
**Estimativa:** 2-3 horas  
**Status:** ‚úÖ CONCLU√çDA (2025-10-24)

**Escopo:**
- [x] Criar `backend/src/agentes/agente_advogado_previdenciario.py`
- [x] Herdar de `AgenteAdvogadoBase`
- [x] Criar prompt focado na an√°lise jur√≠dica de:
  - Concess√£o de benef√≠cios (Aux√≠lio-doen√ßa, Aposentadoria por Invalidez, BPC/LOAS)
  - An√°lise de nexo causal (vis√£o jur√≠dica) para fins de benef√≠cio acident√°rio
  - Tempo de contribui√ß√£o, car√™ncia, qualidade de segurado
  - Legisla√ß√£o: Lei 8.213/91, Decreto 3.048/99, Lei 8.742/93 (LOAS)
- [x] Registrar agente no Coordenador (via import din√¢mico)
- [x] Criar testes unit√°rios completos

**Entreg√°veis:**
- ‚úÖ Agente Advogado Previdenci√°rio funcional
- ‚úÖ Testes unit√°rios completos (test_agente_advogado_previdenciario.py)
- ‚úÖ Changelog completo: `changelogs/TAREFA-026_agente-advogado-previdenciario.md`

---

#### ‚úÖ TAREFA-027: Criar Agente Advogado Especialista - Direito C√≠vel
**Prioridade:** üü¢ M√âDIA  
**Depend√™ncias:** TAREFA-024  
**Estimativa:** 2-3 horas  
**Status:** ‚úÖ CONCLU√çDA (2025-10-24)

**Escopo:**
- [x] Criar `backend/src/agentes/agente_advogado_civel.py`
- [x] Herdar de `AgenteAdvogadoBase`.
- [x] Criar prompt focado na an√°lise jur√≠dica de:
  - [x] Responsabilidade civil (dano material, dano moral).
  - [x] An√°lise de contratos (cl√°usulas, validade, inadimplemento).
  - [x] Direito do consumidor.
- [x] Registrar agente no `OrquestradorMultiAgent`.
- [x] Criar testes unit√°rios completos

**Entreg√°veis:**
- ‚úÖ Agente Advogado C√≠vel funcional.
- ‚úÖ Testes unit√°rios completos (test_agente_advogado_civel.py)
- ‚úÖ Changelog completo: `changelogs/TAREFA-027_agente-advogado-civel.md`

---

#### ‚úÖ TAREFA-028: Criar Agente Advogado Especialista - Direito Tribut√°rio
**Prioridade:** üü¢ M√âDIA  
**Depend√™ncias:** TAREFA-024  
**Estimativa:** 2-3 horas  
**Status:** ‚úÖ CONCLU√çDA (2025-10-24)

**Escopo:**
- [x] Criar `backend/src/agentes/agente_advogado_tributario.py`
- [x] Herdar de `AgenteAdvogadoBase`.
- [x] Criar prompt focado na an√°lise jur√≠dica de:
  - Fato gerador, base de c√°lculo de tributos (ICMS, PIS/COFINS, IRPJ).
  - Execu√ß√£o fiscal, defesa.
  - Bitributa√ß√£o, planejamento tribut√°rio.
- [x] Registrar agente no `OrquestradorMultiAgent` (via import din√¢mico)
- [x] Criar testes unit√°rios completos

**Entreg√°veis:**
- ‚úÖ Agente Advogado Tribut√°rio funcional.
- ‚úÖ Testes unit√°rios completos (test_agente_advogado_tributario.py)
- ‚úÖ Changelog completo: `changelogs/TAREFA-028_agente-advogado-tributario.md`

---

#### üü° TAREFA-029: Atualizar UI para Sele√ß√£o de M√∫ltiplos Agentes
**Prioridade:** üî¥ CR√çTICA  
**Depend√™ncias:** TAREFA-023, TAREFA-028  
**Estimativa:** 3-4 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Modificar `frontend/src/componentes/analise/ComponenteSelecionadorAgentes.tsx` (TAREFA-018).
- [ ] Dividir a UI em duas se√ß√µes claras: "Peritos T√©cnicos" (M√©dico, S. Trabalho) e "Advogados Especialistas" (Trabalhista, Previdenci√°rio, etc.).
- [ ] Chamar o novo endpoint `GET /api/analise/advogados` (criado na TAREFA-024).
- [ ] Atualizar o `armazenamentoAgentes.ts` (Zustand) para armazenar as duas listas.
- [ ] Atualizar `PaginaAnalise.tsx` para passar ambas as listas (`peritos_selecionados` e `advogados_selecionados`) para a API.

**Entreg√°veis:**
- UI que permite selecionar Peritos E Advogados de forma independente.
- Resposta compilada final considerando todos os agentes selecionados.

**Marco:** üéâ **EXPANS√ÉO V2.0 COMPLETA** - Sistema agora suporta sele√ß√£o de contexto e m√∫ltiplos advogados especialistas.

---

### üîµ FASE 5: REARQUITETURA - FLUXO DE AN√ÅLISE ASS√çNCRONO (TAREFAS 030-034)

**Objetivo:** Migrar o processo de an√°lise de s√≠ncrono (request/response) para ass√≠ncrono (polling) para eliminar o risco de timeouts da API.

**Contexto:** An√°lises com m√∫ltiplos agentes podem exceder 2 minutos, causando timeout HTTP. A arquitetura ass√≠ncrona resolve isso permitindo que o frontend fa√ßa polling do status.

---

#### üü° TAREFA-030: Backend - Refatorar Orquestrador para Background Tasks
**Prioridade:** üî¥ CR√çTICA  
**Depend√™ncias:** TAREFA-013, TAREFA-024  
**Estimativa:** 4-5 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Criar um gerenciador de estado de tarefas (ex: um dicion√°rio em mem√≥ria ou cache Redis simples) para armazenar `(consulta_id, {status, resultado})`.
- [ ] Refatorar `backend/src/agentes/orquestrador_multi_agent.py`:
  - [ ] Manter o m√©todo `processar_consulta` (TAREFA-013) como `async`.
  - [ ] Criar um novo m√©todo wrapper (ex: `_processar_consulta_em_background`) que ser√° executado pela `BackgroundTask` do FastAPI.
  - [ ] Este wrapper deve chamar o `processar_consulta` original e, ao final, atualizar o gerenciador de estado com o resultado ou o erro.
- [ ] Garantir que o `OrquestradorMultiAgent` seja instanciado como um singleton (ex: via `lru_cache` ou depend√™ncia do FastAPI) para que o gerenciador de estado seja compartilhado.

**Entreg√°veis:**
- Orquestrador capaz de executar a an√°lise em background e armazenar o resultado.

---

#### üü° TAREFA-031: Backend - Criar Endpoints de An√°lise Ass√≠ncrona
**Prioridade:** üî¥ CR√çTICA  
**Depend√™ncias:** TAREFA-030  
**Estimativa:** 3-4 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Em `backend/src/api/rotas_analise.py`:
  - [ ] DEPRECIAR (mas manter por enquanto) o endpoint s√≠ncrono `POST /api/analise/multi-agent` (TAREFA-014).
  - [ ] **CRIAR** `POST /api/analise/iniciar`:
    - [ ] Recebe o mesmo body da TAREFA-014/022/029 (prompt, agentes, documentos).
    - [ ] Gera um `consulta_id` (UUID).
    - [ ] Inicia a `_processar_consulta_em_background` (da TAREFA-030) usando `BackgroundTasks` do FastAPI.
    - [ ] Retorna imediatamente um JSON: `{ "consulta_id": "...", "status": "INICIADA" }`.
  - [ ] **CRIAR** `GET /api/analise/status/{consulta_id}`:
    - [ ] Consulta o gerenciador de estado.
    - [ ] Retorna JSON: `{ "consulta_id": "...", "status": "PROCESSANDO | CONCLUIDA | ERRO", "progresso": "..." }`.
  - [ ] **CRIAR** `GET /api/analise/resultado/{consulta_id}`:
    - [ ] Consulta o gerenciador de estado.
    - [ ] Se o status for `"CONCLUIDA"`, retorna o JSON completo da an√°lise (o mesmo que o endpoint s√≠ncrono retornava).
    - [ ] Se for `"ERRO"`, retorna a mensagem de erro.
    - [ ] Se for `"PROCESSANDO"`, retorna um erro 425 (Too Early) ou JSON com status processando.
- [ ] Atualizar `ARQUITETURA.md` com os novos endpoints.

**Entreg√°veis:**
- API REST completa para fluxo de an√°lise ass√≠ncrono.

---

#### üü° TAREFA-032: Frontend - Refatorar Servi√ßo de API de An√°lise
**Prioridade:** üî¥ CR√çTICA  
**Depend√™ncias:** TAREFA-031  
**Estimativa:** 2-3 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Em `frontend/src/servicos/servicoApiAnalise.ts`:
  - [ ] MANTER `realizarAnaliseMultiAgent` por compatibilidade, mas marc√°-la como `@deprecated`.
  - [ ] Remover o timeout de 120s da configura√ß√£o do Axios.
  - [ ] **CRIAR** `iniciarAnalise(requestBody) -> Promise<{ consulta_id: string }>`:
    - [ ] Faz `POST /api/analise/iniciar`.
  - [ ] **CRIAR** `verificarStatusAnalise(consulta_id) -> Promise<{ status: string, progresso?: string }>`:
    - [ ] Faz `GET /api/analise/status/{consulta_id}`.
  - [ ] **CRIAR** `obterResultadoAnalise(consulta_id) -> Promise<ResultadoAnalise>`:
    - [ ] Faz `GET /api/analise/resultado/{consulta_id}`.
- [ ] Atualizar `frontend/src/tipos/tiposAgentes.ts` com os novos tipos de status (`StatusAnalise = 'INICIADA' | 'PROCESSANDO' | 'CONCLUIDA' | 'ERRO'`).

**Entreg√°veis:**
- Servi√ßo de API do frontend atualizado para o fluxo ass√≠ncrono.

---

#### üü° TAREFA-033: Frontend - Implementar Polling na P√°gina de An√°lise
**Prioridade:** üî¥ CR√çTICA  
**Depend√™ncias:** TAREFA-029, TAREFA-032  
**Estimativa:** 4-5 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Refatorar `frontend/src/paginas/PaginaAnalise.tsx` (TAREFA-019):
  - [ ] Ao clicar em "Analisar":
    - [ ] Chamar `iniciarAnalise()`.
    - [ ] Mudar a UI para o estado de "Processando" (mostrar spinner, desabilitar bot√µes).
    - [ ] Armazenar o `consulta_id` no estado.
    - [ ] Iniciar um mecanismo de polling (ex: `setInterval` ou `useInterval` hook) para chamar `verificarStatusAnalise()` a cada 2-3 segundos.
  - [ ] **L√≥gica do Polling:**
    - [ ] Se `status === "PROCESSANDO"`, continuar o polling (exibir `progresso` se dispon√≠vel).
    - [ ] Se `status === "ERRO"`, parar o polling e exibir a mensagem de erro.
    - [ ] Se `status === "CONCLUIDA"`:
      - [ ] Parar o polling (limpar o intervalo).
      - [ ] Chamar `obterResultadoAnalise()`.
      - [ ] Exibir os resultados (usando o `ComponenteExibicaoPareceres` j√° existente).
  - [ ] Garantir que o polling seja limpo (`cleared`) se o usu√°rio navegar para fora da p√°gina (ex: `useEffect` cleanup).

**Entreg√°veis:**
- UI que n√£o trava e busca ativamente o resultado, eliminando timeouts.

---

#### üü° TAREFA-034: Frontend - Feedback de Progresso (Opcional, mas Recomendado)
**Prioridade:** üü¢ M√âDIA  
**Depend√™ncias:** TAREFA-033  
**Estimativa:** 2-3 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] **Backend:** Modificar o endpoint `GET /api/analise/status/{consulta_id}` para retornar mais detalhes (ex: `{ status: "PROCESSANDO", etapa_atual: "Analisando com Perito M√©dico", progresso_percentual: 50 }`).
- [ ] **Backend:** O `_processar_consulta_em_background` (TAREFA-030) deve atualizar o gerenciador de estado em cada etapa (RAG, Perito 1, Advogado 1, Compila√ß√£o).
- [ ] **Frontend:** A `PaginaAnalise.tsx` (TAREFA-033) deve exibir a `etapa_atual` e barra de progresso na UI de loading (ex: "Processando... Etapa: Analisando com Perito M√©dico [50%]").

**Entreg√°veis:**
- Melhoria de UX significativa, mostrando ao usu√°rio o progresso da an√°lise em tempo real.

**Marco:** üéâ **REARQUITETURA ASS√çNCRONA COMPLETA** - Risco de timeout eliminado, an√°lises podem demorar quanto necess√°rio.

---

### üîµ FASE 6: MELHORIAS E OTIMIZA√á√ïES (TAREFAS 035-039)

**Objetivo:** Polimento e features avan√ßadas

---

#### üü° TAREFA-035: Sistema de Logging Completo
**Prioridade:** üü° ALTA  
**Depend√™ncias:** TAREFA-014  
**Estimativa:** 2-3 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Configurar Loguru completamente (Logging estruturado JSON).
- [ ] Rota√ß√£o de arquivos de log.
- [ ] Log de custos OpenAI (tokens, $$$).
- [ ] Log de tempo de processamento por agente.

**Entreg√°veis:**
- Sistema de logging robusto e rastreabilidade completa.

---

#### üü° TAREFA-036: Cache de Embeddings e Respostas
**Prioridade:** üü¢ M√âDIA  
**Depend√™ncias:** TAREFA-014  
**Estimativa:** 2-3 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Implementar cache de embeddings (evitar reprocessar mesmo texto).
- [ ] Implementar cache de respostas LLM (prompt id√™ntico, TTL configur√°vel).

**Entreg√°veis:**
- Sistema de cache funcional e redu√ß√£o de custos OpenAI.

---

#### üü° TAREFA-037: Autentica√ß√£o e Autoriza√ß√£o (JWT)
**Prioridade:** üü¢ M√âDIA  
**Depend√™ncias:** TAREFA-014  
**Estimativa:** 4-5 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Implementar autentica√ß√£o JWT (Login, Register).
- [ ] Middleware de autentica√ß√£o em rotas protegidas.
- [ ] Banco de dados de usu√°rios (SQLite ou PostgreSQL).
- [ ] Frontend: tela de login e armazenamento de token.

**Entreg√°veis:**
- Sistema de autentica√ß√£o completo.

---

#### üü° TAREFA-038: Melhorias de Performance
**Prioridade:** üü¢ M√âDIA  
**Depend√™ncias:** TAREFA-036  
**Estimativa:** 3-4 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Profiling do backend (cProfile) e otimizar gargalos.
- [ ] Paraleliza√ß√£o de processamento de m√∫ltiplos arquivos no upload.
- [ ] Lazy loading no frontend e compress√£o de respostas (gzip).

**Entreg√°veis:**
- Melhorias mensur√°veis de performance.

---

#### üü° TAREFA-039: Documenta√ß√£o de Usu√°rio Final
**Prioridade:** üü¢ M√âDIA  
**Depend√™ncias:** TAREFA-029  
**Estimativa:** 2-3 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Criar `MANUAL_DO_USUARIO.md`
- [ ] Guia passo a passo (com screenshots) de como usar a sele√ß√£o de arquivos e a sele√ß√£o de m√∫ltiplos agentes.

**Entreg√°veis:**
- Documenta√ß√£o para usu√°rios finais atualizada para v2.0.

---

### üîµ FASE 7: DEPLOY E INFRAESTRUTURA (TAREFAS 040-042)

**Objetivo:** Colocar sistema em produ√ß√£o

---

#### üü° TAREFA-040: Dockeriza√ß√£o Completa
**Prioridade:** üü° ALTA  
**Depend√™ncias:** TAREFA-014, TAREFA-021  
**Estimativa:** 3-4 horas  
**Status:** üü° PENDENTE
**Nota:** TAREFA-005A j√° fez dockeriza√ß√£o b√°sica, esta tarefa complementa para produ√ß√£o.

**Escopo:**
- [ ] Otimizar `backend/Dockerfile` existente (multi-stage build, reduzir tamanho da imagem).
- [ ] Criar `frontend/Dockerfile` (build de produ√ß√£o otimizado com nginx).
- [ ] Atualizar `docker-compose.yml` para incluir frontend e configura√ß√£o de produ√ß√£o.
- [ ] Garantir persist√™ncia do ChromaDB entre restarts.

**Entreg√°veis:**
- Aplica√ß√£o completamente dockerizada e pronta para produ√ß√£o.

---

#### üü° TAREFA-041: CI/CD (GitHub Actions)
**Prioridade:** üü° ALTA  
**Depend√™ncias:** TAREFA-040  
**Estimativa:** 2-3 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Criar `.github/workflows/backend-ci.yml` (Rodar lint com flake8/black).
- [ ] Criar `.github/workflows/frontend-ci.yml` (Rodar build e lint com ESLint).
- [ ] (Opcional) Deploy autom√°tico em staging.

**Entreg√°veis:**
- Pipeline CI/CD funcional (sem testes, focado em build e lint).

---

#### üü° TAREFA-042: Deploy em Produ√ß√£o
**Prioridade:** üü¢ M√âDIA  
**Depend√™ncias:** TAREFA-041  
**Estimativa:** 4-5 horas  
**Status:** üü° PENDENTE

**Escopo:**
- [ ] Escolher plataforma (Render, Railway, AWS, GCP).
- [ ] Configurar dom√≠nio, HTTPS.
- [ ] Configurar vari√°veis de ambiente em produ√ß√£o.
- [ ] Monitoramento (Sentry) e backup de ChromaDB.

**Entreg√°veis:**
- Sistema rodando em produ√ß√£o.

**Marco:** üéâ **PROJETO COMPLETO EM PRODU√á√ÉO!**


---

## üìä ESTIMATIVAS GLOBAIS

### Por Fase:

| Fase | Tarefas | Estimativa Total | Prioridade Geral |
|------|---------|------------------|------------------|
| **FASE 1: Ingest√£o** | 003-008 (6 tarefas) | 15-21 horas | ‚úÖ CONCLU√çDA |
| **FASE 2: Multi-Agent** | 009-014 (6 tarefas) | 14-20 horas | ‚úÖ CONCLU√çDA |
| **FASE 3: Frontend** | 015-021 (7 tarefas) | 17-24 horas | ‚úÖ CONCLU√çDA |
| **FASE 4: Expans√£o** | 022-029 (8 tarefas) | 19-27 horas | üî¥ CR√çTICA |
| **FASE 5: Rearquitetura** | 030-034 (5 tarefas) | 15-19 horas | üî¥ CR√çTICA |
| **FASE 6: Melhorias** | 035-039 (5 tarefas) | 13-18 horas | üü¢ M√âDIA |
| **FASE 7: Deploy** | 040-042 (3 tarefas) | 9-12 horas | üü° ALTA |

**TOTAL:** 42 tarefas | **102-141 horas** (~3-5 meses em tempo parcial)

---

## üéØ MARCOS (MILESTONES)

1. **‚úÖ FUNDA√á√ÉO COMPLETA** (TAREFA-002) - Conclu√≠do
2. **‚úÖ FLUXO 1 OPERACIONAL** (TAREFA-008) - Upload e processamento funcionando
3. **‚úÖ FLUXO 2 OPERACIONAL** (TAREFA-014) - An√°lise multi-agent (v1.0) funcionando
4. **‚úÖ INTERFACE COMPLETA** (TAREFA-021) - Frontend (v1.0) funcional
5. **ÔøΩ EXPANS√ÉO V2 COMPLETA** (TAREFA-029) - Sele√ß√£o de contexto e advogados especialistas
6. **üî¥ REARQUITETURA ASS√çNCRONA** (TAREFA-034) - Sistema robusto com polling (resolve timeouts)
7. **üéâ SISTEMA EM PRODU√á√ÉO** (TAREFA-042) - Dispon√≠vel publicamente

---

## üö¶ PRIORIZA√á√ÉO SUGERIDA

*(Sprints 1-5 omitidos por estarem conclu√≠dos)*

### Sprint 6 (Semanas 11-12): EXPANS√ÉO (Back-end)

- TAREFA-022: API de Sele√ß√£o de Documentos
- TAREFA-024: Refatorar Infra de Agentes
- TAREFA-025: Agente Advogado Trabalhista
- TAREFA-026: Agente Advogado Previdenci√°rio

### Sprint 7 (Semanas 13-14): EXPANS√ÉO (Front-end)

- TAREFA-023: UI de Sele√ß√£o de Documentos
- TAREFA-027: Agente Advogado C√≠vel
- TAREFA-028: Agente Advogado Tribut√°rio
- TAREFA-029: UI de Sele√ß√£o de M√∫ltiplos Agentes

### Sprint 8 (Semanas 15-16): REARQUITETURA ASS√çNCRONA (Backend)

- TAREFA-030: Refatorar Orquestrador para Background Tasks
- TAREFA-031: Criar Endpoints Ass√≠ncronos (/iniciar, /status, /resultado)

### Sprint 9 (Semanas 17-18): REARQUITETURA ASS√çNCRONA (Frontend)

- TAREFA-032: Refatorar Servi√ßo API (polling)
- TAREFA-033: Implementar Polling na PaginaAnalise
- TAREFA-034: Feedback de Progresso (opcional)

### Sprint 10 (Semanas 19-20): MELHORIAS E DEPLOY

- TAREFA-035: Sistema de Logging Completo
- TAREFA-040: Dockeriza√ß√£o Completa
- TAREFA-041: CI/CD (GitHub Actions)
- TAREFA-042: Deploy em Produ√ß√£o

*(Tarefas de melhorias adicionais (036-039) podem ser intercaladas conforme necessidade)*

---

## üìù NOTAS IMPORTANTES

### Para IAs Futuras:

1. **Sempre seguir o AI_MANUAL_DE_MANUTENCAO.md**
2. **Atualizar CHANGELOG_IA.md ap√≥s cada tarefa**
3. **Atualizar ARQUITETURA.md quando adicionar/modificar endpoints ou agentes**
4. **Manter padr√£o de coment√°rios exaustivos**
5. **Foco em robustez, j√° que os testes automatizados foram removidos do escopo.**

### Depend√™ncias Externas Cr√≠ticas:

- **OpenAI API Key** (obrigat√≥ria para todo o sistema)
- **Tesseract OCR** (instalado no OS)
- **Poppler** (para pdf2image)

### Riscos Identificados:

1. **Custo OpenAI:** Muitas chamadas de API podem gerar custos altos
   - Mitiga√ß√£o: Cache (TAREFA-036), limites de uso
2. **Performance do OCR:** PDFs grandes podem demorar
   - Mitiga√ß√£o: Processamento ass√≠ncrono, feedback de progresso
3. **Qualidade dos pareceres:** LLM pode alucinar
   - Mitiga√ß√£o: Prompts bem estruturados, compila√ß√£o pelo Agente Coordenador
4. **Timeout em an√°lises longas:** M√∫ltiplos agentes podem exceder 120s (arquitetura s√≠ncrona atual)
   - Mitiga√ß√£o: Rearquitetura ass√≠ncrona com polling (FASE 5, TAREFAS 030-034) - **CR√çTICO**
5. **Aus√™ncia de Testes:** A remo√ß√£o dos testes aumenta o risco de regress√µes
   - Mitiga√ß√£o: Verifica√ß√£o manual cuidadosa, logging exaustivo (TAREFA-035)

---

**üöÄ Vamos construir a v2.0!**
